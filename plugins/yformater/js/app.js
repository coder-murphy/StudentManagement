chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_link"),id:"link",contexts:["selection"],onclick:link});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_json"),id:"json",onclick:json});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_cjson"),id:"cjson",onclick:cjson});chrome.contextMenus.create({type:"separator"});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_copy"),id:"copy",onclick:copy});chrome.contextMenus.create({type:"separator"});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_lock"),id:"lock"});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_lock_url"),id:"lockURL",parentId:"lock",onclick:lockURL});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_lock_domain"),id:"lockDomain",parentId:"lock",onclick:lockDomain});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_lock_cancel"),id:"lockCancel",parentId:"lock",onclick:lockCancel});chrome.contextMenus.create({type:"separator"});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_theme"),id:"theme"});chrome.contextMenus.create({type:"radio",title:"rainbow",id:"themeRainbow",parentId:"theme",checked:(!localStorage.theme)||(localStorage.theme=="rainbow"),onclick:themeRainbow});chrome.contextMenus.create({type:"radio",title:"tomorrow",id:"themeTomorrow",parentId:"theme",checked:localStorage.theme=="tomorrow",onclick:themeTomorrow});chrome.contextMenus.create({type:"radio",title:"monokai_sublime",id:"themeMonokaiSublime",parentId:"theme",checked:localStorage.theme=="monokai-sublime",onclick:themeMonokaiSublime});chrome.contextMenus.create({type:"radio",title:"github",id:"themeGithub",parentId:"theme",checked:localStorage.theme=="github",onclick:themeGithub});chrome.contextMenus.create({type:"radio",title:"notepad2-mod",id:"themeNotepad2Mod",parentId:"theme",checked:localStorage.theme=="notepad2-mod",onclick:themeNotepad2Mod});chrome.contextMenus.create({type:"radio",title:"spacegray-light",id:"spacegrayLight",parentId:"theme",checked:localStorage.theme=="spacegray-light",onclick:spacegrayLight});chrome.contextMenus.create({type:"normal",title:chrome.i18n.getMessage("file_app_font"),id:"font"});chrome.contextMenus.create({type:"radio",title:"13px",id:"font13",parentId:"font",checked:localStorage.font==(!localStorage.font)||(localStorage.font=="f13"),onclick:font13});chrome.contextMenus.create({type:"radio",title:"16px",id:"font16",parentId:"font",checked:localStorage.font=="f16",onclick:font16});chrome.contextMenus.create({type:"radio",title:"18px",id:"font18",parentId:"font",checked:localStorage.font=="f18",onclick:font18});chrome.contextMenus.create({type:"radio",title:"20px",id:"font20",parentId:"font",checked:localStorage.font=="f20",onclick:font20});function json(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-format","control":false,"theme":localStorage.theme||"rainbow","font":localStorage.font||"f13"},function(data){})})}function jsonx(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-format","control":true,"theme":localStorage.theme||"rainbow"},function(data){})})}function cjson(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-format","control":false,"clipboard":true,"theme":localStorage.theme||"rainbow","font":localStorage.font||"f13"},function(data){})})}function cjsonx(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-format","control":true,"clipboard":true,"theme":localStorage.theme||"rainbow"},function(data){})})}function link(info,tab){var url=info.selectionText;chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-link","ext":url},function(data){})})}function copy(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-copy"},function(data){})})}function themeRainbow(info,tab){localStorage.theme="rainbow"}function themeTomorrow(info,tab){localStorage.theme="tomorrow"}function themeMonokaiSublime(info,tab){localStorage.theme="monokai-sublime"}function themeGithub(info,tab){localStorage.theme="github"}function themeNotepad2Mod(info,tab){localStorage.theme="notepad2-mod"}function spacegrayLight(info,tab){localStorage.theme="spacegray-light"}function lockURL(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-lock","url":true},function(data){})
})}function lockDomain(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-lock","domain":true},function(data){})})}function lockCancel(info,tab){chrome.tabs.query({active:true,currentWindow:true},function(tabs){var tabId=tabs[0].id;chrome.tabs.sendMessage(tabId,{"message":"yformater-lock","cancel":true},function(data){})})}function font13(info,tab){localStorage.font="f13"}function font16(info,tab){localStorage.font="f16"}function font18(info,tab){localStorage.font="f18"}function font20(info,tab){localStorage.font="f20"}function keypressOn(url,rules){var regex,regexs,i;if(!rules){return true}regexs=rules.split("\n");for(i in regexs){regex=regexs[i];if(regex.indexOf("^")!=0){regex="^"+regex}if(regex.lastIndexOf("$")!=regex.length-1){regex=regex+"$"}regex=new RegExp(regex);if(regex.test(url)){return false}}return true}chrome.runtime.onMessage.addListener(function(request,sender,sendResponse){var i,prop,props,m;if(request.message=="local-storage"){if(request.method=="read"){props=request.props;m={};for(i in request.props){m[props[i]]=localStorage[props[i]]}sendResponse(m)}if(request.method=="write"){props=request.props;for(prop in request.props){localStorage[prop]=props[prop]}}}});chrome.runtime.onMessage.addListener(function(request,sender,sendResponse){if(request.message=="icon"){if(request.method=="active"){chrome.browserAction.setBadgeBackgroundColor({color:[85,85,85,255],tabId:sender.tab.id});chrome.browserAction.setBadgeText({text:request.text,tabId:sender.tab.id})}}});chrome.runtime.onMessage.addListener(function(request,sender,sendResponse){if(request.message=="keyboard-shortcut"){if(request.method=="check"){sendResponse.call(null,keypressOn(request.url,localStorage["keypress_ignore_rules"]))}}});